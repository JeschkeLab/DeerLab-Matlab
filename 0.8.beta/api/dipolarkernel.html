

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dipolarkernel &mdash; DeerLab  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="../../develop/_static/custom.css" type="text/css" /><link rel="stylesheet" href="../../develop/_static/theme_override.css" type="text/css" /><link rel="stylesheet" href="../../develop/_static/custom.css" type="text/css" /><link rel="stylesheet" href="../../develop/_static/theme_override.css" type="text/css" />    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dipolarsignal" href="dipolarsignal.html" />
    <link rel="prev" title="deerload" href="deerload.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div class="select">
    <select onChange="window.location.href=this.value">
        <option selected value="">0.8.beta</option>
        <option value="../../0.6.beta/api/dipolarkernel.html">0.6.beta</option>
        <option value="../../develop/api/dipolarkernel.html">develop</option>
    </select>
    <div class="select_arrow">
    </div>
</div>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">First Steps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Parametric Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DeerLab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../functions.html">Functions</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dipolarkernel">
<span id="id1"></span><h1><code class="xref mat mat-mod docutils literal notranslate"><span class="pre">dipolarkernel</span></code><a class="headerlink" href="#dipolarkernel" title="Permalink to this headline">¶</a></h1>
<p>Computes the dipolar interaction kernel for the linear transformation from a distance-domain distribution to a time-domain dipolar signal.</p>
<hr class="docutils" />
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="s">&#39;Property&#39;</span><span class="p">,</span><span class="n">Value</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="s">&#39;Property&#39;</span><span class="p">,</span><span class="n">Value</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Parameters</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">t</span></code>      - Time axis vector (<em>N</em>-element array)</li>
<li><code class="docutils literal notranslate"><span class="pre">r</span></code>      -  Distance axis vector (<em>M</em>-element array)</li>
<li><code class="docutils literal notranslate"><span class="pre">lambda</span></code> - Modulation depth (scalar)</li>
<li><code class="docutils literal notranslate"><span class="pre">B</span></code>      -  Background function vector (<em>N</em>-element array)</li>
</ul>
</dd>
<dt>Returns</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">K</span></code> - Dipolar kernel (<em>NxM</em>-element matrix)</li>
</ul>
</dd>
</dl>
</div>
<hr class="docutils" />
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
<p>Computes <code class="docutils literal notranslate"><span class="pre">K</span></code> for the transformation to the dipolar evolution function from the time axis <code class="docutils literal notranslate"><span class="pre">t</span></code> and distance axis <code class="docutils literal notranslate"><span class="pre">r</span></code>. This kernel will describe the transformation from the distance distribution <img class="math" src="../_images/math/2e1b9128d3c9b8fb56d099ad56863fd3a9137bb9.svg" alt="\mathbf{P}"/> to the dipolar evolution function <img class="math" src="../_images/math/244af957eb308f5e4c9267a2371c210c563b8794.svg" alt="\mathbf{D}"/>, meaning</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/c69b330c8965ffe8d1f57dfe7bf5d7b82b6bdd55.svg" alt="\mathbf{K}\mathbf{P}  = \mathbf{D}"/></p>
</div></div></blockquote>
<p>Since the dipolar kernel is normalized by <img class="math" src="../_images/math/2b39036dc8392ebdedb7e33a3b4dc9c630266dcd.svg" alt="\Delta r"/>, in order to obtain the correct time-domain signal via <code class="docutils literal notranslate"><span class="pre">S=K*P</span></code>, the distance distribution must be properly normalized by <img class="math" src="../_images/math/2b39036dc8392ebdedb7e33a3b4dc9c630266dcd.svg" alt="\Delta r"/> as well. By default, all distribution <code class="docutils literal notranslate"><span class="pre">P</span></code> returned by DeerLab are already normalized.</p>
<hr class="docutils" />
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">)</span>
</pre></div>
</div>
<p>If the modulation depth <code class="docutils literal notranslate"><span class="pre">lambda</span></code> is specified, then its information is included into the kernel function. This kernel will describe the transformation from the distance distribution to the form factor <img class="math" src="../_images/math/12375c0b63626372bb53f970422bbbf888b2a1f2.svg" alt="\mathbf{F}"/> given by</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/55fe1ad1f5c8ae372482f3f6cf93c732aaedcc83.svg" alt="\mathbf{K}\mathbf{P}  = \mathbf{F} = (1-\lambda) + \lambda \mathbf{D}"/></p>
</div></div></blockquote>
<hr class="docutils" />
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<p>If the background <code class="docutils literal notranslate"><span class="pre">B</span></code> and modulation depth <code class="docutils literal notranslate"><span class="pre">lambda</span></code> variables are specified, then the background is included into the kernel function. This kernel will describe the transformation from the distance distribution to the primary signal <img class="math" src="../_images/math/f11108f9246387772dca9f482bc3f49075335b8a.svg" alt="\mathbf{V}"/> given by</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/3dee3495e565f24defaa6adaa7a300e6a58aa6cb.svg" alt="\mathbf{K}\mathbf{P}  = \mathbf{V} = [(1-\lambda) + \lambda \mathbf{D} ]\mathbf{B}"/></p>
</div></div></blockquote>
</div>
<hr class="docutils" />
<div class="section" id="optional-arguments">
<h2>Optional Arguments<a class="headerlink" href="#optional-arguments" title="Permalink to this headline">¶</a></h2>
<p>Optional arguments can be specified by parameter/value pairs. All property names are case insensitive and the property-value pairs can be passed in any order after the required input arguments have been passed..</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;Property1&#39;</span><span class="p">,</span><span class="n">Value1</span><span class="p">,</span><span class="s">&#39;Property2&#39;</span><span class="p">,</span><span class="n">Value2</span><span class="p">,</span><span class="c">...)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="s">&#39;Property1&#39;</span><span class="p">,</span><span class="n">Value1</span><span class="p">,</span><span class="s">&#39;Property2&#39;</span><span class="p">,</span><span class="n">Value2</span><span class="p">,</span><span class="c">...)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="s">&#39;Property1&#39;</span><span class="p">,</span><span class="n">Value1</span><span class="p">,</span><span class="s">&#39;Property2&#39;</span><span class="p">,</span><span class="n">Value2</span><span class="p">,</span><span class="c">...)</span>
</pre></div>
</div>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'ExcitationBandwidth'</span></code> - Excitation bandwith of the pulses in <strong>MHz</strong>.</dt>
<dd><p class="first">If specified, its value is used in the compensation of limited excitation bandwidth of the experimental pulses. If not specified infinite excitation bandwidth is assumed. The compensation for a given excitation bandwidth <img class="math" src="../_images/math/9ccba61f6fd5c2b926b897f756af9c60f61cd012.svg" alt="\Delta\omega"/> is taken into account by the approximation</p>
<div class="math">
<p><img src="../_images/math/a7b5e7f1e6d09649356a96158c5b77d0f1dc4d97.svg" alt="K(t,r,\Delta\omega)  = exp\left(-\frac{\omega_{dd}^2}{\Delta\omega^2}\right)K(t,r)"/></p>
</div><p><em>Default:</em> [<em>empty</em>]</p>
<p><em>Example:</em></p>
<div class="last highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;ExcitationBandwidth&#39;</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="c">%Correct for 50 MHz excitation bandwidth</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'OvertoneCoeffs'</span></code> - RIDME overtone coefficients</dt>
<dd><p class="first">1D-Array containing the overtone coefficients for RIDME experimens. If passed, the dipolar kernel overtones are calculated based on the passed coefficients. The coefficient values must be normalized. The kernel containing up to the <img class="math" src="../_images/math/4047168aa989d7d2ccdbe51f5f498b42234f0a09.svg" alt="K^{th}"/> overtone is constructed as follows</p>
<div class="math">
<p><img src="../_images/math/66b4d48609de5a1737fd11df150e137992ef9d05.svg" alt="K(t,r)  = \int_{0}^{\pi/2}\sum_{k=1}^K P_k\cos\left[(3\cos^2\theta -1)k\frac{\mu_0\hbar\gamma_A\gamma_B}{4\pi r^3}t\right]\sin\theta d\theta"/></p>
</div><p>where <img class="math" src="../_images/math/5fde09a8bd2c6c2bbd322d3f2a0a5f74b3abfd4c.svg" alt="P_k"/> are the overtone coefficients passed as arguments.</p>
<p><em>Default:</em> [<em>empty</em>]</p>
<p><em>Example:</em></p>
<blockquote class="last">
<div><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;OvertoneCoeffs&#39;</span><span class="p">,[</span><span class="mf">0.4</span> <span class="mf">0.2</span> <span class="mf">0.4</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'gValue'</span></code> - Electron g-value</dt>
<dd><p class="first">Specifies the g-value of the electron spin center used to compute the dipolar frequencies from the given distance axis.</p>
<p><em>Default:</em> <code class="docutils literal notranslate"><span class="pre">2.004602204236924</span></code></p>
<p><em>Example:</em></p>
<blockquote class="last">
<div><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;gValue&#39;</span><span class="p">,</span><span class="mf">2.00</span><span class="p">)</span> <span class="c">%Use experimental g-value</span>
</pre></div>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'Method'</span></code> - Numerical Kernel construction method</dt>
<dd><p class="first">Specifies the way the kernel is computed numerically.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">'fresnel'</span></code> - Employs Fresnel integrals for the kernel calculation (fast).</li>
<li><code class="docutils literal notranslate"><span class="pre">'explicit'</span></code> - Employs explicit powder averaging for the kernel calculation (slow).</li>
</ul>
<p><em>Default:</em> <code class="docutils literal notranslate"><span class="pre">'fresnel'</span></code></p>
<p><em>Example:</em></p>
<blockquote class="last">
<div><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;Method&#39;</span><span class="p">,</span><span class="s">&#39;explicit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'Knots'</span></code> - Number of powder orientations</dt>
<dd><p class="first">If the kernel is computed using the <code class="docutils literal notranslate"><span class="pre">'explicit'</span></code> powder averaging, this options specifies the number knots for the grid of powder orientations used for the powder averaging.</p>
<p><em>Default:</em> <code class="docutils literal notranslate"><span class="pre">1001</span></code></p>
<p><em>Example:</em></p>
<div class="last highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;Method&#39;</span><span class="p">,</span><span class="s">&#39;explicit&#39;</span><span class="p">,</span><span class="s">&#39;Knots&#39;</span><span class="p">,</span><span class="mi">2001</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'MultiPathway'</span></code> - Dipolar multipathway kernel</dt>
<dd><p class="first">Parameters of the dipolar multi-pathway model. Passed as a cell array containing the following parameters:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">etas</span></code>  - Time-shifts of the individual dipolar pathways. (N-vector)</li>
<li><code class="docutils literal notranslate"><span class="pre">lambdas</span></code>  - Amplitudes of the different pathways. The first element is the amplitude of the unmodulated component and the remaining elements are the amplitudes of the modulated components. (N+1-vector).</li>
<li><code class="docutils literal notranslate"><span class="pre">Bmodel</span></code>  - Background model, must accept the time axis and the pathway amplitude as inputs. (function handle)</li>
</ul>
</div></blockquote>
<p><em>Default:</em> [<em>empty</em>]</p>
<p><em>Example:</em></p>
<div class="last highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">lambdas</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.5</span> <span class="mf">0.3</span> <span class="mf">0.2</span><span class="p">];</span>
<span class="n">etas</span> <span class="p">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="mf">5.4</span><span class="p">];</span>
<span class="n">Bmodel</span> <span class="p">=</span> <span class="p">@(</span><span class="n">t</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span> <span class="n">td_strexp</span><span class="p">(</span><span class="n">t</span><span class="p">,[</span><span class="n">kappa</span><span class="o">*</span><span class="n">lam</span> <span class="n">d</span><span class="p">]);</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="s">&#39;MultiPathway&#39;</span><span class="p">,{</span><span class="n">lambdas</span> <span class="n">etas</span> <span class="n">Bmodel</span><span class="p">})</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dipolarsignal.html" class="btn btn-neutral float-right" title="dipolarsignal" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="deerload.html" class="btn btn-neutral float-left" title="deerload" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Luis Fabregas Ibanez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>