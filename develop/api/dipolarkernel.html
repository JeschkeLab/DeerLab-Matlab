

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dipolarkernel &mdash; DeerLab  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="/source/_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="/source/_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/table_util.css" type="text/css" />
  <link rel="stylesheet" href="../_static/table_main.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="aptkernel" href="aptkernel.html" />
    <link rel="prev" title="Functions" href="../functions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div class="select">
    <select onChange="window.location.href=this.value">
        <option value="../../0.8.beta/api/dipolarkernel.html">0.8.beta</option>
        <option value="../../0.6.beta/api/dipolarkernel.html">0.6.beta</option>
        <option selected value="">develop</option>
    </select>
    <div class="select_arrow">
    </div>
</div>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<p class="caption"><span class="caption-text">User guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Downloads</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../download.html#downloading-releases">Downloading Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../download.html#downloading-the-source-code">Downloading the source code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#setup">Setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#tutorials-basics">Tutorials - Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#tutorials-advanced">Tutorials - Advanced</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../functions.html">Functions</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../functions.html#modeling">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions.html#analysis">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions.html#pre-processing">Pre-Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions.html#model-selection">Model Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../functions.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ddmodels.html">Distribution models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ddmodels.html#parameter-free-distance-distributions">Parameter-free distance distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ddmodels.html#parametric-distance-distributions">Parametric distance distributions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bgmodels.html">Background models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/bg_exp.html"><code class="docutils literal notranslate"><span class="pre">bg_exp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/bg_poly1.html"><code class="docutils literal notranslate"><span class="pre">bg_poly1</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/bg_poly2.html"><code class="docutils literal notranslate"><span class="pre">bg_poly2</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/bg_poly3.html"><code class="docutils literal notranslate"><span class="pre">bg_poly3</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/bg_prodstrexp.html"><code class="docutils literal notranslate"><span class="pre">bg_prodstrexp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/bg_strexp.html"><code class="docutils literal notranslate"><span class="pre">bg_strexp</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/bg_sumstrexp.html"><code class="docutils literal notranslate"><span class="pre">bg_sumstrexp</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../expmodels.html">Experiment models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/exp_4pdeer.html"><code class="docutils literal notranslate"><span class="pre">exp_4pdeer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/exp_5pdeer.html"><code class="docutils literal notranslate"><span class="pre">exp_5pdeer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/exp_ovl4pdeer.html"><code class="docutils literal notranslate"><span class="pre">exp_ovl4pdeer</span></code></a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DeerLab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../functions.html">Functions</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dipolarkernel">
<span id="id1"></span><h1><code class="xref mat mat-mod docutils literal notranslate"><span class="pre">dipolarkernel</span></code><a class="headerlink" href="#dipolarkernel" title="Permalink to this headline">¶</a></h1>
<p>Computes the dipolar kernel matrix  that transforms a distance distribution to a time-domain dipolar signal.</p>
<hr class="docutils" />
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathinfo</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathinfo</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">___</span><span class="p">,</span><span class="s">&#39;Property&#39;</span><span class="p">,</span><span class="n">Value</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Parameters</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">t</span></code>        - Time axis vector (<em>N</em>-element array), in microseconds</li>
<li><code class="docutils literal notranslate"><span class="pre">r</span></code>        - Distance axis vector (<em>M</em>-element array), in nanometers</li>
<li><code class="docutils literal notranslate"><span class="pre">lambda</span></code>   - Modulation depth (scalar)</li>
<li><code class="docutils literal notranslate"><span class="pre">pathinfo</span></code> - Modulation depths, refocusing times, and harmonics (<em>px2</em> or <em>px3</em> array) for multiple dipolar pathways</li>
<li><code class="docutils literal notranslate"><span class="pre">B</span></code>        - Background, either vector of values (<em>N</em>-element array) or function handle</li>
</ul>
</dd>
<dt>Returns</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">K</span></code> - Dipolar kernel matrix (<em>NxM</em> array)</li>
</ul>
</dd>
</dl>
</div>
<hr class="docutils" />
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
<p>Computes the kernel matrix <code class="docutils literal notranslate"><span class="pre">K</span></code> for the time axis <code class="docutils literal notranslate"><span class="pre">t</span></code> (in microseconds) and distance axis <code class="docutils literal notranslate"><span class="pre">r</span></code> (in nanometers). <code class="docutils literal notranslate"><span class="pre">K</span></code> transforms a distance distribution <img class="math" src="../_images/math/2e1b9128d3c9b8fb56d099ad56863fd3a9137bb9.svg" alt="\mathbf{P}"/> to a dipolar evolution function <img class="math" src="../_images/math/244af957eb308f5e4c9267a2371c210c563b8794.svg" alt="\mathbf{D}"/></p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/c69b330c8965ffe8d1f57dfe7bf5d7b82b6bdd55.svg" alt="\mathbf{K}\mathbf{P}  = \mathbf{D}"/></p>
</div></div></blockquote>
<p>The dipolar kernel is normalized by <img class="math" src="../_images/math/2b39036dc8392ebdedb7e33a3b4dc9c630266dcd.svg" alt="\Delta r"/>, such that it returns a dipolar signal with amplitude 1 at time zero for a normalized distance distribution (i.e. <code class="docutils literal notranslate"><span class="pre">sum(P)*dr==1</span></code>). By default, all distributions <code class="docutils literal notranslate"><span class="pre">P</span></code> generated by DeerLab model distribution functions are already normalized.</p>
<hr class="docutils" />
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">)</span>
</pre></div>
</div>
<p>If the modulation depth <code class="docutils literal notranslate"><span class="pre">lambda</span></code> (a number between 0 and 1) is specified, then it is included into the kernel matrix. <code class="docutils literal notranslate"><span class="pre">K</span></code> then describes the transformation from the distance distribution to a time-domain signal <img class="math" src="../_images/math/f11108f9246387772dca9f482bc3f49075335b8a.svg" alt="\mathbf{V}"/> that includes a constant offset of amplitude <img class="math" src="../_images/math/21dd856b01a8c4549861224cca8d5da5d7570aed.svg" alt="1-\lambda"/>, and dipolar modulation with amplitude <img class="math" src="../_images/math/76f1d8ace30435987c01a00ca53a71cba1f40e6c.svg" alt="\lambda"/>:</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/55fe1ad1f5c8ae372482f3f6cf93c732aaedcc83.svg" alt="\mathbf{K}\mathbf{P}  = \mathbf{F} = (1-\lambda) + \lambda \mathbf{D}"/></p>
</div></div></blockquote>
<hr class="docutils" />
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<p>If the background <code class="docutils literal notranslate"><span class="pre">B</span></code> and modulation depth <code class="docutils literal notranslate"><span class="pre">lambda</span></code> are specified, then both are included into the kernel matrix. <code class="docutils literal notranslate"><span class="pre">B</span></code> can be either an array with the pre-calculated background decay (over <code class="docutils literal notranslate"><span class="pre">t</span></code>), or a function handle with a background model. <code class="docutils literal notranslate"><span class="pre">K</span></code> describes the transformation from the distance distribution to the dipolar signal <img class="math" src="../_images/math/f11108f9246387772dca9f482bc3f49075335b8a.svg" alt="\mathbf{V}"/> given by</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/3dee3495e565f24defaa6adaa7a300e6a58aa6cb.svg" alt="\mathbf{K}\mathbf{P}  = \mathbf{V} = [(1-\lambda) + \lambda \mathbf{D} ]\mathbf{B}"/></p>
</div></div></blockquote>
<hr class="docutils" />
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathinfo</span><span class="p">)</span>
<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathinfo</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<p>For a multi-pathway DEER signal (e.g, 4-pulse DEER with 2+1 contribution; 5-pulse DEER with 4-pulse DEER residual signal, and more complicated experiments), <code class="docutils literal notranslate"><span class="pre">pathinfo</span></code> is a 2D array that contains a list of modulation depths (amplitudes), refocusing times (in microseconds), and optional harmonics for all modulated pathway signals.</p>
<p>Each row of <code class="docutils literal notranslate"><span class="pre">pathinfo</span></code> contains two values: one modulation depth and one refocusing time. For a pathway with unmodulated signal, set the refocusing time to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p>Optionally, the harmonic (1 = fundamental, 2 = first overtone, etc.) can be given as a third value in each row. This can be useful for modeling RIDME signals. If not given, the harmonic is 1 for all pathways.</p>
<dl class="docutils">
<dt>Example 1:</dt>
<dd>To specify the standard model for 4-pulse DEER with an unmodulated offset and a single dipolar pathway that refocuses at time 0, use</dd>
</dl>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">lambda</span> <span class="p">=</span> <span class="mf">0.4</span><span class="p">;</span> <span class="c">% modulation depth main signal</span>

<span class="n">pathinfo</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">lambda</span> <span class="n">NaN</span><span class="p">;</span> <span class="n">lambda</span> <span class="s">0]</span><span class="p">;</span>

<span class="c">% alternative input</span>
<span class="n">pathinfo</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">-</span><span class="n">lambda</span> <span class="n">NaN</span><span class="p">];</span>    <span class="c">% unmodulated part, gives offset</span>
<span class="n">pathinfo</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span> <span class="p">=</span> <span class="p">[</span><span class="n">lambda</span> <span class="mi">0</span><span class="p">];</span>        <span class="c">% main modulation, refocusing at time zero</span>

<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathinfo</span><span class="p">);</span>
</pre></div>
</div>
<p>The shorthand input syntax <code class="docutils literal notranslate"><span class="pre">dipolarkernel(t,r,lambda)</span></code> is equivalent to this input.</p>
<dl class="docutils">
<dt>Example 2:</dt>
<dd>To specify a more complete 4-pulse DEER model that includes the 2+1 contribution, use</dd>
</dl>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">Lambda0</span> <span class="p">=</span> <span class="mf">0.5</span><span class="p">;</span>   <span class="c">% unmodulated part</span>
<span class="n">lambda</span> <span class="p">=</span> <span class="mf">0.4</span><span class="p">;</span>    <span class="c">% modulation depth main signal</span>
<span class="n">lambda21</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>  <span class="c">% modulation depth 2+1 contribution</span>
<span class="n">tau2</span> <span class="p">=</span> <span class="mi">4</span><span class="p">;</span>        <span class="c">% refocusing time of 2+1 contribution</span>

<span class="n">pathinfo</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span> <span class="p">=</span> <span class="p">[</span><span class="n">Lambda0</span>  <span class="n">NaN</span><span class="p">];</span>     <span class="c">% unmodulated part, gives offset</span>
<span class="n">pathinfo</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span> <span class="p">=</span> <span class="p">[</span><span class="n">lambda4</span>  <span class="mi">0</span><span class="p">];</span>       <span class="c">% main modulation, refocusing at time zero</span>
<span class="n">pathinfo</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span> <span class="p">=</span> <span class="p">[</span><span class="n">lambda21</span> <span class="n">tau2</span><span class="p">];</span>    <span class="c">% 2+1 modulation, refocusing at time tau2</span>

<span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathinfo</span><span class="p">);</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="additional-settings">
<h2>Additional Settings<a class="headerlink" href="#additional-settings" title="Permalink to this headline">¶</a></h2>
<p>Additional settings can be specified via name-value pairs. All property names are case insensitive and the property-value pairs can be passed in any order after the required input arguments have been passed.</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">___</span><span class="p">,</span><span class="s">&#39;Property1&#39;</span><span class="p">,</span><span class="n">Value1</span><span class="p">,</span><span class="s">&#39;Property2&#39;</span><span class="p">,</span><span class="n">Value2</span><span class="p">,</span><span class="n">___</span><span class="p">)</span>
</pre></div>
</div>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'ExcitationBandwidth'</span></code> - Excitation bandwidth of the pulses in <strong>MHz</strong>.</dt>
<dd><p class="first">Use this to include limited excitation bandwidth of the experimental pulses. If not specified, infinite excitation bandwidth is assumed. The compensation for a given excitation bandwidth <img class="math" src="../_images/math/9ccba61f6fd5c2b926b897f756af9c60f61cd012.svg" alt="\Delta\omega"/> is taken into account by the approximation</p>
<div class="math">
<p><img src="../_images/math/65c804118f9e22ab3ccb05666fd082b177274d1f.svg" alt="K_{\Delta\omega}(t,r)  = \mathrm{exp}\left(-\frac{\omega_\mathrm{dd}^2}{\Delta\omega^2}\right)K(t,r)"/></p>
</div><p><em>Default:</em> [<em>empty</em>]</p>
<p><em>Example:</em></p>
<div class="last highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="s">&#39;ExcitationBandwidth&#39;</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>     <span class="c">% 50 MHz excitation bandwidth</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'OvertoneCoeffs'</span></code> - RIDME overtone coefficients</dt>
<dd><p class="first">1D array containing the overtone coefficients for RIDME experiments. If passed, the dipolar kernel overtones are calculated based on the passed coefficients. The coefficient values must be normalized. The kernel containing up to the <img class="math" src="../_images/math/3af01b3f850c53aa06a7ef9878392efada5f2e71.svg" alt="k^{th}"/> overtone is constructed as follows</p>
<div class="math">
<p><img src="../_images/math/ba4bf7b903ede0daa0ca6ca4f1e2d7d4b90f6ac7.svg" alt="K(t,r)  = \int_{0}^{1}\sum_{k=1}^K c_k\cos\left[(3\cos^2\theta -1)k\frac{\mu_0\hbar\gamma_A\gamma_B}{4\pi r^3}t\right]\mathrm{d} \cos\theta"/></p>
</div><p>where <img class="math" src="../_images/math/f330e54fd76a21140c67b3893aa4b7cad3b99677.svg" alt="c_k"/> are the overtone coefficients passed as arguments.</p>
<p><em>Default:</em> [<em>empty</em>]</p>
<p><em>Example:</em></p>
<blockquote class="last">
<div><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;OvertoneCoeffs&#39;</span><span class="p">,[</span><span class="mf">0.4</span> <span class="mf">0.2</span> <span class="mf">0.4</span><span class="p">])</span>   <span class="c">% fundamental, 1st, and 2nd overtone</span>
</pre></div>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'g'</span></code> - Electron g-value</dt>
<dd><p class="first">Specifies the two g-values of the electron spin centers used to compute the dipolar frequencies from the given distance axis.</p>
<p><em>Default:</em> free-electron g value</p>
<p><em>Example:</em></p>
<blockquote class="last">
<div><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;g&#39;</span><span class="p">,[</span><span class="mf">2.01</span> <span class="mf">2.1</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'Method'</span></code> - Kernel matrix calculation method</dt>
<dd><p class="first">Specifies the method the kernel matrix is computed numerically.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">'fresnel'</span></code> - Uses Fresnel integrals. This method is fast and accurate.</li>
<li><code class="docutils literal notranslate"><span class="pre">'integral'</span></code> - Uses MATLAB’s <code class="docutils literal notranslate"><span class="pre">integral()</span></code> function. This method is accurate, but slow.</li>
<li><code class="docutils literal notranslate"><span class="pre">'grid'</span></code> - Uses orientation averaging over a grid of orientations, using the number of orientations given in <code class="docutils literal notranslate"><span class="pre">nKnots</span></code>. This method is slow, and it converges very slowly with the number of orientations.</li>
</ul>
<p><em>Default:</em> <code class="docutils literal notranslate"><span class="pre">'fresnel'</span></code></p>
<p><em>Example:</em></p>
<blockquote class="last">
<div><div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;Method&#39;</span><span class="p">,</span><span class="s">&#39;integral&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'nKnots'</span></code> - Number of orientations for orientation averaging</dt>
<dd><p class="first">If the kernel is computed using <code class="docutils literal notranslate"><span class="pre">'grid'</span></code>, this options specifies the number of orientations between <img class="math" src="../_images/math/6ec2bbf7a32453b73f5491ba196a2337f6ed8454.svg" alt="\theta=0"/> and <img class="math" src="../_images/math/a36212354b76eb8fc2775b00942add57dd68a3c6.svg" alt="\theta=\pi/2"/> used for orientation averaging.</p>
<p><em>Default:</em> <code class="docutils literal notranslate"><span class="pre">5001</span></code></p>
<p><em>Example:</em></p>
<div class="last highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;Method&#39;</span><span class="p">,</span><span class="s">&#39;grid&#39;</span><span class="p">,</span><span class="s">&#39;nKnots&#39;</span><span class="p">,</span><span class="mf">1e4</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">'Renormalize'</span></code> - Re-normalization of multi-pathway dipolar kernels</dt>
<dd><p class="first">If the kernel is computed for a multi-pathway model via the <code class="docutils literal notranslate"><span class="pre">pathinfo</span></code> variable, the kernel does not necessarily satisfy <code class="docutils literal notranslate"><span class="pre">V(0)</span> <span class="pre">==</span> <span class="pre">1</span></code>. This option enables(<code class="docutils literal notranslate"><span class="pre">true</span></code>) or disables(<code class="docutils literal notranslate"><span class="pre">false</span></code>) a re-normalization to ensure that equality is satisfied.</p>
<p><em>Default:</em> <code class="docutils literal notranslate"><span class="pre">true</span></code></p>
<p><em>Example:</em></p>
<div class="last highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="p">=</span> <span class="n">dipolarkernel</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="s">&#39;Renormalize&#39;</span><span class="p">,</span><span class="n">false</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aptkernel.html" class="btn btn-neutral float-right" title="aptkernel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../functions.html" class="btn btn-neutral float-left" title="Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-2020, Luis Fábregas Ibáñez, Stefan Stoll, and others

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>