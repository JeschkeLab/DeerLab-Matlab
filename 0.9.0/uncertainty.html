

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Uncertainty &mdash; DeerLab  documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="../develop/_static/custom.css" type="text/css" /><link rel="stylesheet" href="../develop/_static/theme_override.css" type="text/css" /><link rel="stylesheet" href="../develop/_static/custom.css" type="text/css" />  <link rel="stylesheet" href="_static/table_util.css" type="text/css" />
  <link rel="stylesheet" href="_static/table_main.css" type="text/css" />
<link rel="stylesheet" href="../develop/_static/theme_override.css" type="text/css" />    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example scripts" href="examples.html" />
    <link rel="prev" title="Fitting" href="fitting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div class="select">
    <select onChange="window.location.href=this.value">
        <option selected value="">0.9.0</option>
        <option value="../develop/uncertainty.html">develop</option>
    </select>
    <div class="select_arrow">
    </div>
</div>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting DeerLab</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download</a><ul>
<li class="toctree-l2"><a class="reference internal" href="download.html#downloading-releases">Downloading Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="download.html#downloading-the-source-code">Downloading the source code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#setup">Setup</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="firstscript.html">A first script</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="basics.html#distance-distributions">Distance distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html#backgrounds">Backgrounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html#experiments">Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html#time-domain-signals">Time-domain signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html#kernel-matrices">Kernel matrices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="preprocess.html">Loading and preprocessing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="preprocess.html#loading">Loading</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocess.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocess.html#noise-levels">Noise levels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fitting.html">Fitting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#picking-the-model">Picking the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#parameter-free-distribution">Parameter-free distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#parametric-distributions">Parametric distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#background-fitting">Background fitting</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Uncertainty</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#covariance-cis">Covariance CIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bootstrap-cis">Bootstrap CIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example scripts</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="functions.html">Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html#modeling">Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#analysis">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#pre-processing">Pre-Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#model-selection">Model Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#utilities">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html#legacy-functions">Legacy Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modelsref.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modelsref.html#distribution-models">Distribution models</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelsref.html#background-models">Background models</a></li>
<li class="toctree-l2"><a class="reference internal" href="modelsref.html#experiment-models">Experiment models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="theory.html#assumptions">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#distance-distributions">Distance distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#dipolar-signals-and-kernels">Dipolar signals and kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#discretization">Discretization</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#least-squares-fitting">Least-squares fitting</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DeerLab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Uncertainty</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="uncertainty">
<h1>Uncertainty<a class="headerlink" href="#uncertainty" title="Permalink to this headline">¶</a></h1>
<p>After fitting experimental data with a distance distribution, a background, and a modulation depth, it is important to assess the uncertainty (i.e. the error) in the fitted parameters.</p>
<p>DeerLab provides uncertainty estimates for all parameters in the form of confidence intervals (CIs). They can be calculated in two ways: either using the covariance matrix, or using bootstrap. The first method is fast, but is not entirely accurate, whereas bootstrap is much slower, but more robust.</p>
<div class="section" id="covariance-cis">
<h2>Covariance CIs<a class="headerlink" href="#covariance-cis" title="Permalink to this headline">¶</a></h2>
<p>Along with every fit, functions like <code class="docutils literal notranslate"><span class="pre">fitsignal</span></code> return confidence intervals for the fitted parameters and the fitted distributions. For example,</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Vfit</span><span class="p">,</span><span class="n">Pfit</span><span class="p">,</span><span class="n">Bfit</span><span class="p">,</span><span class="n">parfit</span><span class="p">,</span><span class="n">parCI</span><span class="p">]</span> <span class="p">=</span> <span class="n">fitsignal</span><span class="p">(</span><span class="n">Vexp</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">);</span>
</pre></div>
</div>
<p>The output <code class="docutils literal notranslate"><span class="pre">parCI</span></code> contains the 95% confidence interval for all fitted parameters, calculated using the standard method based on the variance-covariance matrix.</p>
</div>
<div class="section" id="bootstrap-cis">
<h2>Bootstrap CIs<a class="headerlink" href="#bootstrap-cis" title="Permalink to this headline">¶</a></h2>
<p>A more thorough way of assessing parameter uncertainty is bootstrap. In this method, many additional synthetic datasets are generated from the given experimental data and the fitted model and are fitted individually. This yields an ensemble of parameter fits that is analyzed statistically to provide information about the scatter.</p>
<p>Here is an example for a parametric model:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">bootci</span> <span class="p">=</span> <span class="n">bootan</span><span class="p">(@(</span><span class="n">V</span><span class="p">)</span><span class="n">fitfcn</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">K</span><span class="p">),</span><span class="n">Vexp</span><span class="p">,</span><span class="n">Vfit</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="s">&#39;verbose&#39;</span><span class="p">,</span><span class="n">true</span><span class="p">);</span>

<span class="n">function</span> <span class="s">parfit</span> <span class="s">=</span> <span class="s">fitfcn(Vin,r,K)</span>
       <span class="n">parfit</span> <span class="p">=</span> <span class="n">fitparamodel</span><span class="p">(</span><span class="n">Vin</span><span class="p">,@</span><span class="n">dd_gauss</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">K</span><span class="p">);</span>
<span class="n">end</span>
</pre></div>
</div>
<p>The output <code class="docutils literal notranslate"><span class="pre">bootci</span></code> contains calculated bootstrap 50%, 90%, and 95% confidence intervals for all parameters.</p>
<p>Here is an example for a model with a parameter-free distribution:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">bootci</span> <span class="p">=</span> <span class="n">bootan</span><span class="p">(@(</span><span class="n">V</span><span class="p">)</span><span class="n">fitfcn</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">),</span><span class="n">Vexp</span><span class="p">,</span><span class="n">Vfit</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="s">&#39;verbose&#39;</span><span class="p">,</span><span class="n">true</span><span class="p">);</span>

<span class="n">function</span> <span class="s">[Pfit,</span> <span class="s">parfit.bg,</span> <span class="s">parfit.ex]</span> <span class="s">=</span> <span class="s">fitfcn(Vin,t,r)</span>
       <span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">Pfit</span><span class="p">,</span><span class="o">~</span><span class="p">,</span><span class="n">parfit</span><span class="p">]</span> <span class="p">=</span> <span class="n">fitsignal</span><span class="p">(</span><span class="n">Vin</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="s">&#39;P&#39;</span><span class="p">,@</span><span class="n">bg_hom3d</span><span class="p">,@</span><span class="n">ex_4pdeer</span><span class="p">,[],</span><span class="s">&#39;RegParam&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">end</span>
</pre></div>
</div>
<p>To plot the resulting CIs for the parameter-free distance distribution, use</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">Pci</span> <span class="p">=</span> <span class="n">bootci</span><span class="p">{</span><span class="mi">1</span><span class="p">}.</span><span class="n">ci95</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">Pfit</span><span class="p">,</span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">Pci</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">Pci</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples.html" class="btn btn-neutral float-right" title="Example scripts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fitting.html" class="btn btn-neutral float-left" title="Fitting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-2020, Luis Fábregas Ibáñez, Stefan Stoll, and others

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>